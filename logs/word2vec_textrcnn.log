2021-03-15 19:36:11
dataManager initialed...
mode: train_classifier
model: textrcnn
loading data...
loading data...
++++++++++++++++++++training starting++++++++++++++++++++
epoch:1/30
training batch:    20, loss: 0.44630, precision: 0.857 recall: 0.727 f1: 0.787 
training batch:    40, loss: 0.50250, precision: 0.696 recall: 0.914 f1: 0.790 
training batch:    60, loss: 0.49466, precision: 0.864 recall: 0.559 f1: 0.679 
training batch:    80, loss: 0.37593, precision: 0.667 recall: 1.000 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.7208333333333333, 'recall': 0.8357487922705314, 'f1-score': 0.7740492170022372, 'support': 207}
positive: {'precision': 0.8468468468468469, 'recall': 0.7372549019607844, 'f1-score': 0.7882599580712788, 'support': 255}
time consumption:1.85(min), loss: 0.507 precision: 0.847 recall: 0.737 f1: 0.788 
saved the new best model with f1: 0.788
epoch:2/30
training batch:    20, loss: 0.40504, precision: 0.829 recall: 0.879 f1: 0.853 
training batch:    40, loss: 0.54663, precision: 0.853 recall: 0.784 f1: 0.817 
training batch:    60, loss: 0.37078, precision: 0.805 recall: 0.917 f1: 0.857 
training batch:    80, loss: 0.69863, precision: 0.667 recall: 1.000 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.7746478873239436, 'recall': 0.7971014492753623, 'f1-score': 0.7857142857142857, 'support': 207}
positive: {'precision': 0.8313253012048193, 'recall': 0.8117647058823529, 'f1-score': 0.8214285714285715, 'support': 255}
time consumption:1.95(min), loss: 0.474 precision: 0.831 recall: 0.812 f1: 0.821 
saved the new best model with f1: 0.821
epoch:3/30
training batch:    20, loss: 0.55058, precision: 0.750 recall: 0.750 f1: 0.750 
training batch:    40, loss: 0.42160, precision: 0.816 recall: 0.838 f1: 0.827 
training batch:    60, loss: 0.46301, precision: 0.848 recall: 0.848 f1: 0.848 
training batch:    80, loss: 0.46858, precision: 0.500 recall: 0.500 f1: 0.500 
start evaluate engines...

negative: {'precision': 0.755868544600939, 'recall': 0.7777777777777778, 'f1-score': 0.7666666666666667, 'support': 207}
positive: {'precision': 0.8152610441767069, 'recall': 0.796078431372549, 'f1-score': 0.8055555555555556, 'support': 255}
time consumption:1.87(min), loss: 0.529 precision: 0.815 recall: 0.796 f1: 0.806 
epoch:4/30
training batch:    20, loss: 0.46352, precision: 0.806 recall: 0.935 f1: 0.866 
training batch:    40, loss: 0.33915, precision: 0.846 recall: 0.880 f1: 0.863 
training batch:    60, loss: 0.41167, precision: 0.759 recall: 0.846 f1: 0.800 
training batch:    80, loss: 0.16979, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7647058823529411, 'recall': 0.7536231884057971, 'f1-score': 0.759124087591241, 'support': 207}
positive: {'precision': 0.8023255813953488, 'recall': 0.8117647058823529, 'f1-score': 0.8070175438596492, 'support': 255}
time consumption:1.91(min), loss: 0.503 precision: 0.802 recall: 0.812 f1: 0.807 
epoch:5/30
training batch:    20, loss: 0.31959, precision: 0.872 recall: 0.919 f1: 0.895 
training batch:    40, loss: 0.35822, precision: 0.897 recall: 0.795 f1: 0.843 
training batch:    60, loss: 0.33098, precision: 1.000 recall: 0.778 f1: 0.875 
training batch:    80, loss: 0.47406, precision: 0.800 recall: 1.000 f1: 0.889 
start evaluate engines...

negative: {'precision': 0.7433628318584071, 'recall': 0.8115942028985508, 'f1-score': 0.7759815242494226, 'support': 207}
positive: {'precision': 0.8347457627118644, 'recall': 0.7725490196078432, 'f1-score': 0.8024439918533605, 'support': 255}
time consumption:1.95(min), loss: 0.537 precision: 0.835 recall: 0.773 f1: 0.802 
epoch:6/30
training batch:    20, loss: 0.38043, precision: 0.812 recall: 0.929 f1: 0.867 
training batch:    40, loss: 0.43630, precision: 0.775 recall: 0.912 f1: 0.838 
training batch:    60, loss: 0.32191, precision: 0.800 recall: 0.870 f1: 0.833 
training batch:    80, loss: 0.21596, precision: 1.000 recall: 0.667 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.7560975609756098, 'recall': 0.748792270531401, 'f1-score': 0.7524271844660193, 'support': 207}
positive: {'precision': 0.7976653696498055, 'recall': 0.803921568627451, 'f1-score': 0.80078125, 'support': 255}
time consumption:1.95(min), loss: 0.507 precision: 0.798 recall: 0.804 f1: 0.801 
epoch:7/30
training batch:    20, loss: 0.25065, precision: 0.906 recall: 0.906 f1: 0.906 
training batch:    40, loss: 0.36015, precision: 0.875 recall: 0.848 f1: 0.862 
training batch:    60, loss: 0.25465, precision: 0.931 recall: 0.871 f1: 0.900 
training batch:    80, loss: 0.15322, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7897435897435897, 'recall': 0.7439613526570048, 'f1-score': 0.7661691542288557, 'support': 207}
positive: {'precision': 0.8014981273408239, 'recall': 0.8392156862745098, 'f1-score': 0.8199233716475096, 'support': 255}
time consumption:1.98(min), loss: 0.549 precision: 0.801 recall: 0.839 f1: 0.820 
epoch:8/30
training batch:    20, loss: 0.36081, precision: 0.933 recall: 0.875 f1: 0.903 
training batch:    40, loss: 0.24854, precision: 0.886 recall: 1.000 f1: 0.940 
training batch:    60, loss: 0.25081, precision: 0.826 recall: 0.974 f1: 0.894 
training batch:    80, loss: 0.19237, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.807909604519774, 'recall': 0.6908212560386473, 'f1-score': 0.7447916666666666, 'support': 207}
positive: {'precision': 0.775438596491228, 'recall': 0.8666666666666667, 'f1-score': 0.8185185185185185, 'support': 255}
time consumption:2.18(min), loss: 0.643 precision: 0.775 recall: 0.867 f1: 0.819 
epoch:9/30
training batch:    20, loss: 0.24558, precision: 0.912 recall: 0.969 f1: 0.939 
training batch:    40, loss: 0.23309, precision: 1.000 recall: 0.774 f1: 0.873 
training batch:    60, loss: 0.16571, precision: 0.909 recall: 0.968 f1: 0.937 
training batch:    80, loss: 0.27461, precision: 1.000 recall: 0.833 f1: 0.909 
start evaluate engines...

negative: {'precision': 0.8160919540229885, 'recall': 0.6859903381642513, 'f1-score': 0.7454068241469816, 'support': 207}
positive: {'precision': 0.7743055555555556, 'recall': 0.8745098039215686, 'f1-score': 0.8213627992633519, 'support': 255}
time consumption:2.11(min), loss: 0.797 precision: 0.774 recall: 0.875 f1: 0.821 
epoch:10/30
training batch:    20, loss: 0.20957, precision: 1.000 recall: 0.848 f1: 0.918 
training batch:    40, loss: 0.20155, precision: 0.842 recall: 1.000 f1: 0.914 
training batch:    60, loss: 0.10691, precision: 0.968 recall: 0.968 f1: 0.968 
training batch:    80, loss: 0.17493, precision: 0.667 recall: 1.000 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.7810945273631841, 'recall': 0.7584541062801933, 'f1-score': 0.769607843137255, 'support': 207}
positive: {'precision': 0.8084291187739464, 'recall': 0.8274509803921568, 'f1-score': 0.8178294573643411, 'support': 255}
time consumption:2.22(min), loss: 0.772 precision: 0.808 recall: 0.827 f1: 0.818 
early stopped, no progress obtained within 8 epochs
overall best f1 is 0.8214285714285715 at 2 epoch
total training time consumption: 19.998(min)
