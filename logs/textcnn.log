2021-03-15 16:59:02
{
  "classifier": "textcnn",
  "train_file": "data/data/train_data.csv",
  "embedding_method": null,
  "embedding_dim": 300,
  "token_file": "data/data/token2id",
  "dev_file": "data/data/dev_data.csv",
  "classes": {
    "negative": 0,
    "positive": 1
  },
  "checkpoints_dir": "model/textcnn",
  "checkpoint_name": "textcnn",
  "num_filters": 64,
  "learning_rate": 0.001,
  "epoch": 30,
  "max_to_keep": 1,
  "print_per_batch": 20,
  "is_early_stop": true,
  "use_attention": false,
  "attention_dim": 300,
  "patient": 8,
  "batch_size": 64,
  "max_sequence_length": 150,
  "droupout_rate": 0.5,
  "hidden_dim": 200,
  "metrics_average": "binary",
  "use_focal_loss": false
}
dataManager initialed...
mode: train_classifier
model: textcnn
loading data...
loading data...
++++++++++++++++++++training starting++++++++++++++++++++
epoch:1/30
training batch:    20, loss: 0.66996, precision: 0.472 recall: 0.926 f1: 0.625 
training batch:    40, loss: 0.64393, precision: 0.615 recall: 0.774 f1: 0.686 
training batch:    60, loss: 0.52680, precision: 0.700 recall: 0.840 f1: 0.764 
training batch:    80, loss: 0.32946, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.8265895953757225, 'recall': 0.6908212560386473, 'f1-score': 0.7526315789473684, 'support': 207}
positive: {'precision': 0.7785467128027682, 'recall': 0.8823529411764706, 'f1-score': 0.8272058823529411, 'support': 255}
time consumption:0.38(min), loss: 0.477 precision: 0.779 recall: 0.882 f1: 0.827 
saved the new best model with f1: 0.827
epoch:2/30
training batch:    20, loss: 0.42698, precision: 0.864 recall: 0.655 f1: 0.745 
training batch:    40, loss: 0.33123, precision: 0.875 recall: 0.824 f1: 0.848 
training batch:    60, loss: 0.22379, precision: 0.970 recall: 0.914 f1: 0.941 
training batch:    80, loss: 0.55158, precision: 1.000 recall: 0.667 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.8010471204188482, 'recall': 0.7391304347826086, 'f1-score': 0.7688442211055276, 'support': 207}
positive: {'precision': 0.8007380073800738, 'recall': 0.8509803921568627, 'f1-score': 0.8250950570342205, 'support': 255}
time consumption:0.36(min), loss: 0.452 precision: 0.801 recall: 0.851 f1: 0.825 
epoch:3/30
training batch:    20, loss: 0.19529, precision: 0.941 recall: 0.941 f1: 0.941 
training batch:    40, loss: 0.26363, precision: 0.969 recall: 0.861 f1: 0.912 
training batch:    60, loss: 0.17744, precision: 0.927 recall: 0.974 f1: 0.950 
training batch:    80, loss: 0.06133, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7828282828282829, 'recall': 0.748792270531401, 'f1-score': 0.7654320987654321, 'support': 207}
positive: {'precision': 0.803030303030303, 'recall': 0.8313725490196079, 'f1-score': 0.8169556840077071, 'support': 255}
time consumption:0.36(min), loss: 0.498 precision: 0.803 recall: 0.831 f1: 0.817 
epoch:4/30
training batch:    20, loss: 0.06081, precision: 0.969 recall: 1.000 f1: 0.984 
training batch:    40, loss: 0.22788, precision: 0.906 recall: 0.935 f1: 0.921 
training batch:    60, loss: 0.11084, precision: 0.976 recall: 0.930 f1: 0.952 
training batch:    80, loss: 0.01144, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7361111111111112, 'recall': 0.7681159420289855, 'f1-score': 0.7517730496453902, 'support': 207}
positive: {'precision': 0.8048780487804879, 'recall': 0.7764705882352941, 'f1-score': 0.7904191616766466, 'support': 255}
time consumption:0.36(min), loss: 0.617 precision: 0.805 recall: 0.776 f1: 0.790 
epoch:5/30
training batch:    20, loss: 0.15851, precision: 1.000 recall: 0.944 f1: 0.971 
training batch:    40, loss: 0.08288, precision: 0.970 recall: 0.970 f1: 0.970 
training batch:    60, loss: 0.08572, precision: 0.914 recall: 1.000 f1: 0.955 
training batch:    80, loss: 0.26285, precision: 0.750 recall: 1.000 f1: 0.857 
start evaluate engines...

negative: {'precision': 0.7512437810945274, 'recall': 0.7294685990338164, 'f1-score': 0.7401960784313725, 'support': 207}
positive: {'precision': 0.7854406130268199, 'recall': 0.803921568627451, 'f1-score': 0.7945736434108527, 'support': 255}
time consumption:0.37(min), loss: 0.698 precision: 0.785 recall: 0.804 f1: 0.795 
epoch:6/30
training batch:    20, loss: 0.03034, precision: 1.000 recall: 0.966 f1: 0.982 
training batch:    40, loss: 0.02496, precision: 0.969 recall: 1.000 f1: 0.984 
training batch:    60, loss: 0.06574, precision: 0.943 recall: 1.000 f1: 0.971 
training batch:    80, loss: 0.04100, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7378640776699029, 'recall': 0.7342995169082126, 'f1-score': 0.7360774818401936, 'support': 207}
positive: {'precision': 0.78515625, 'recall': 0.788235294117647, 'f1-score': 0.7866927592954991, 'support': 255}
time consumption:0.36(min), loss: 0.802 precision: 0.785 recall: 0.788 f1: 0.787 
epoch:7/30
training batch:    20, loss: 0.07805, precision: 0.933 recall: 1.000 f1: 0.966 
training batch:    40, loss: 0.06956, precision: 0.963 recall: 0.963 f1: 0.963 
training batch:    60, loss: 0.07163, precision: 0.971 recall: 0.943 f1: 0.957 
training batch:    80, loss: 0.00208, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7294685990338164, 'recall': 0.7294685990338164, 'f1-score': 0.7294685990338166, 'support': 207}
positive: {'precision': 0.7803921568627451, 'recall': 0.7803921568627451, 'f1-score': 0.7803921568627451, 'support': 255}
time consumption:0.37(min), loss: 0.860 precision: 0.780 recall: 0.780 f1: 0.780 
epoch:8/30
training batch:    20, loss: 0.01629, precision: 1.000 recall: 1.000 f1: 1.000 
training batch:    40, loss: 0.03308, precision: 0.970 recall: 1.000 f1: 0.985 
training batch:    60, loss: 0.03507, precision: 1.000 recall: 1.000 f1: 1.000 
training batch:    80, loss: 0.00263, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.722488038277512, 'recall': 0.7294685990338164, 'f1-score': 0.7259615384615384, 'support': 207}
positive: {'precision': 0.7786561264822134, 'recall': 0.7725490196078432, 'f1-score': 0.7755905511811024, 'support': 255}
time consumption:0.37(min), loss: 0.960 precision: 0.779 recall: 0.773 f1: 0.776 
epoch:9/30
training batch:    20, loss: 0.07859, precision: 0.970 recall: 0.970 f1: 0.970 
training batch:    40, loss: 0.19283, precision: 0.929 recall: 0.963 f1: 0.945 
training batch:    60, loss: 0.06564, precision: 0.969 recall: 1.000 f1: 0.984 
training batch:    80, loss: 0.00450, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.729064039408867, 'recall': 0.714975845410628, 'f1-score': 0.7219512195121951, 'support': 207}
positive: {'precision': 0.7722007722007722, 'recall': 0.7843137254901961, 'f1-score': 0.7782101167315175, 'support': 255}
time consumption:0.36(min), loss: 0.957 precision: 0.772 recall: 0.784 f1: 0.778 
early stopped, no progress obtained within 8 epochs
overall best f1 is 0.8272058823529411 at 1 epoch
total training time consumption: 3.298(min)
