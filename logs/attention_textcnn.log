2021-03-29 12:02:01
{
  "classifier": "textcnn",
  "train_file": "data/data/train_data.csv",
  "embedding_method": null,
  "embedding_dim": 300,
  "token_file": "data/data/token2id",
  "dev_file": "data/data/dev_data.csv",
  "classes": {
    "negative": 0,
    "positive": 1
  },
  "checkpoints_dir": "model/attention_textcnn",
  "checkpoint_name": "attention_textcnn",
  "num_filters": 64,
  "learning_rate": 0.001,
  "epoch": 30,
  "max_to_keep": 1,
  "print_per_batch": 20,
  "is_early_stop": true,
  "use_attention": true,
  "attention_size": 300,
  "patient": 8,
  "batch_size": 64,
  "max_sequence_length": 150,
  "dropout_rate": 0.5,
  "hidden_dim": 200,
  "metrics_average": "binary",
  "use_focal_loss": false
}
dataManager initialed...
mode: train_classifier
model: textcnn
loading data...
loading data...
++++++++++++++++++++training starting++++++++++++++++++++
epoch:1/30
training batch:    20, loss: 0.69114, precision: 0.562 recall: 1.000 f1: 0.720 
training batch:    40, loss: 0.69433, precision: 0.500 recall: 1.000 f1: 0.667 
training batch:    60, loss: 0.69611, precision: 0.453 recall: 1.000 f1: 0.624 
training batch:    80, loss: 0.68152, precision: 0.667 recall: 1.000 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 207}
positive: {'precision': 0.551948051948052, 'recall': 1.0, 'f1-score': 0.7112970711297071, 'support': 255}
time consumption:0.54(min), loss: 0.690 precision: 0.552 recall: 1.000 f1: 0.711 
saved the new best model with f1: 0.711
epoch:2/30
training batch:    20, loss: 0.69705, precision: 0.469 recall: 1.000 f1: 0.638 
training batch:    40, loss: 0.70192, precision: 0.422 recall: 1.000 f1: 0.593 
training batch:    60, loss: 0.68781, precision: 0.578 recall: 1.000 f1: 0.733 
training batch:    80, loss: 0.66970, precision: 0.667 recall: 1.000 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 207}
positive: {'precision': 0.551948051948052, 'recall': 1.0, 'f1-score': 0.7112970711297071, 'support': 255}
time consumption:0.41(min), loss: 0.687 precision: 0.552 recall: 1.000 f1: 0.711 
epoch:3/30
training batch:    20, loss: 0.68894, precision: 0.452 recall: 0.966 f1: 0.615 
training batch:    40, loss: 0.68735, precision: 0.516 recall: 1.000 f1: 0.681 
training batch:    60, loss: 0.68099, precision: 0.500 recall: 0.839 f1: 0.627 
training batch:    80, loss: 0.71427, precision: 0.400 recall: 0.667 f1: 0.500 
start evaluate engines...

negative: {'precision': 0.5933333333333334, 'recall': 0.8599033816425121, 'f1-score': 0.7021696252465482, 'support': 207}
positive: {'precision': 0.8209876543209876, 'recall': 0.5215686274509804, 'f1-score': 0.6378896882494005, 'support': 255}
time consumption:0.45(min), loss: 0.660 precision: 0.821 recall: 0.522 f1: 0.638 
epoch:4/30
training batch:    20, loss: 0.65147, precision: 0.706 recall: 0.375 f1: 0.490 
training batch:    40, loss: 0.61682, precision: 0.611 recall: 0.710 f1: 0.657 
training batch:    60, loss: 0.63122, precision: 0.676 recall: 0.714 f1: 0.694 
training batch:    80, loss: 0.45515, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7577319587628866, 'recall': 0.7101449275362319, 'f1-score': 0.7331670822942643, 'support': 207}
positive: {'precision': 0.7761194029850746, 'recall': 0.8156862745098039, 'f1-score': 0.7954110898661568, 'support': 255}
time consumption:0.44(min), loss: 0.576 precision: 0.776 recall: 0.816 f1: 0.795 
saved the new best model with f1: 0.795
epoch:5/30
training batch:    20, loss: 0.55224, precision: 0.805 recall: 0.805 f1: 0.805 
training batch:    40, loss: 0.65289, precision: 0.607 recall: 0.607 f1: 0.607 
training batch:    60, loss: 0.51200, precision: 0.778 recall: 0.800 f1: 0.789 
training batch:    80, loss: 0.44944, precision: 0.750 recall: 0.750 f1: 0.750 
start evaluate engines...

negative: {'precision': 0.8228571428571428, 'recall': 0.6956521739130435, 'f1-score': 0.7539267015706805, 'support': 207}
positive: {'precision': 0.7804878048780488, 'recall': 0.8784313725490196, 'f1-score': 0.8265682656826568, 'support': 255}
time consumption:0.41(min), loss: 0.498 precision: 0.780 recall: 0.878 f1: 0.827 
saved the new best model with f1: 0.827
epoch:6/30
training batch:    20, loss: 0.46226, precision: 0.714 recall: 0.909 f1: 0.800 
training batch:    40, loss: 0.47196, precision: 0.818 recall: 0.844 f1: 0.831 
training batch:    60, loss: 0.43070, precision: 0.903 recall: 0.800 f1: 0.848 
training batch:    80, loss: 0.29877, precision: 0.800 recall: 1.000 f1: 0.889 
start evaluate engines...

negative: {'precision': 0.7846153846153846, 'recall': 0.7391304347826086, 'f1-score': 0.7611940298507462, 'support': 207}
positive: {'precision': 0.797752808988764, 'recall': 0.8352941176470589, 'f1-score': 0.8160919540229884, 'support': 255}
time consumption:0.40(min), loss: 0.473 precision: 0.798 recall: 0.835 f1: 0.816 
epoch:7/30
training batch:    20, loss: 0.40329, precision: 0.743 recall: 0.867 f1: 0.800 
training batch:    40, loss: 0.39114, precision: 0.800 recall: 0.828 f1: 0.814 
training batch:    60, loss: 0.36891, precision: 0.941 recall: 0.914 f1: 0.928 
training batch:    80, loss: 0.24604, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.788659793814433, 'recall': 0.7391304347826086, 'f1-score': 0.7630922693266832, 'support': 207}
positive: {'precision': 0.7985074626865671, 'recall': 0.8392156862745098, 'f1-score': 0.8183556405353728, 'support': 255}
time consumption:0.39(min), loss: 0.465 precision: 0.799 recall: 0.839 f1: 0.818 
epoch:8/30
training batch:    20, loss: 0.30019, precision: 0.865 recall: 0.914 f1: 0.889 
training batch:    40, loss: 0.38501, precision: 0.862 recall: 0.862 f1: 0.862 
training batch:    60, loss: 0.44891, precision: 0.810 recall: 0.895 f1: 0.850 
training batch:    80, loss: 0.10432, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7647058823529411, 'recall': 0.7536231884057971, 'f1-score': 0.759124087591241, 'support': 207}
positive: {'precision': 0.8023255813953488, 'recall': 0.8117647058823529, 'f1-score': 0.8070175438596492, 'support': 255}
time consumption:0.40(min), loss: 0.466 precision: 0.802 recall: 0.812 f1: 0.807 
epoch:9/30
training batch:    20, loss: 0.28725, precision: 0.862 recall: 0.862 f1: 0.862 
training batch:    40, loss: 0.24890, precision: 0.941 recall: 0.914 f1: 0.928 
training batch:    60, loss: 0.26793, precision: 0.906 recall: 0.879 f1: 0.892 
training batch:    80, loss: 0.23615, precision: 0.800 recall: 1.000 f1: 0.889 
start evaluate engines...

negative: {'precision': 0.7581395348837209, 'recall': 0.7874396135265701, 'f1-score': 0.7725118483412322, 'support': 207}
positive: {'precision': 0.8218623481781376, 'recall': 0.796078431372549, 'f1-score': 0.8087649402390438, 'support': 255}
time consumption:0.40(min), loss: 0.474 precision: 0.822 recall: 0.796 f1: 0.809 
epoch:10/30
training batch:    20, loss: 0.27330, precision: 0.972 recall: 0.921 f1: 0.946 
training batch:    40, loss: 0.20237, precision: 0.933 recall: 0.966 f1: 0.949 
training batch:    60, loss: 0.30070, precision: 0.882 recall: 0.909 f1: 0.896 
training batch:    80, loss: 0.54947, precision: 0.750 recall: 0.750 f1: 0.750 
start evaluate engines...

negative: {'precision': 0.7722772277227723, 'recall': 0.7536231884057971, 'f1-score': 0.762836185819071, 'support': 207}
positive: {'precision': 0.8038461538461539, 'recall': 0.8196078431372549, 'f1-score': 0.8116504854368931, 'support': 255}
time consumption:0.40(min), loss: 0.481 precision: 0.804 recall: 0.820 f1: 0.812 
epoch:11/30
training batch:    20, loss: 0.23854, precision: 0.913 recall: 0.913 f1: 0.913 
training batch:    40, loss: 0.35196, precision: 0.879 recall: 0.829 f1: 0.853 
training batch:    60, loss: 0.34137, precision: 0.848 recall: 0.875 f1: 0.862 
training batch:    80, loss: 0.20689, precision: 0.750 recall: 1.000 f1: 0.857 
start evaluate engines...

negative: {'precision': 0.7766497461928934, 'recall': 0.7391304347826086, 'f1-score': 0.7574257425742574, 'support': 207}
positive: {'precision': 0.7962264150943397, 'recall': 0.8274509803921568, 'f1-score': 0.8115384615384615, 'support': 255}
time consumption:0.40(min), loss: 0.492 precision: 0.796 recall: 0.827 f1: 0.812 
epoch:12/30
training batch:    20, loss: 0.19201, precision: 0.914 recall: 1.000 f1: 0.955 
training batch:    40, loss: 0.22387, precision: 0.879 recall: 0.967 f1: 0.921 
training batch:    60, loss: 0.19786, precision: 0.906 recall: 0.935 f1: 0.921 
training batch:    80, loss: 0.11502, precision: 1.000 recall: 1.000 f1: 1.000 
start evaluate engines...

negative: {'precision': 0.7609756097560976, 'recall': 0.7536231884057971, 'f1-score': 0.7572815533980584, 'support': 207}
positive: {'precision': 0.8015564202334631, 'recall': 0.807843137254902, 'f1-score': 0.8046875, 'support': 255}
time consumption:0.40(min), loss: 0.506 precision: 0.802 recall: 0.808 f1: 0.805 
epoch:13/30
training batch:    20, loss: 0.21207, precision: 0.968 recall: 0.882 f1: 0.923 
training batch:    40, loss: 0.19289, precision: 0.972 recall: 1.000 f1: 0.986 
training batch:    60, loss: 0.23142, precision: 0.914 recall: 0.941 f1: 0.928 
training batch:    80, loss: 0.28382, precision: 1.000 recall: 0.667 f1: 0.800 
start evaluate engines...

negative: {'precision': 0.7794871794871795, 'recall': 0.7342995169082126, 'f1-score': 0.7562189054726368, 'support': 207}
positive: {'precision': 0.7940074906367042, 'recall': 0.8313725490196079, 'f1-score': 0.8122605363984674, 'support': 255}
time consumption:0.39(min), loss: 0.518 precision: 0.794 recall: 0.831 f1: 0.812 
early stopped, no progress obtained within 8 epochs
overall best f1 is 0.8265682656826568 at 5 epoch
total training time consumption: 5.445(min)
